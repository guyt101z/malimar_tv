<div class="splash">
    <div class="container">
        <div class="figure hidden-xs hidden-sm"><%= image_tag "figure-04.png" %></div>
        <h3>Works on Xbox 360®,  Playstation 3®, HDTV/Blue-ray™ player, Android™ Devices, Roku®, Ipad® or computer</h3>
        <div class="fz12">* Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod.</div>
    </div>
</div><!--splash-->
<div class="content">
    <div class="container">
        <% @child_grids = Grid.where(grid_id: @grid.id)     %>

        <% @child_grids.each do |grid| %>
            <%
            grandchild_grids = Grid.where(grid_id: grid.id).order(weight: :desc)
            if grid.class_type == 'Show'
                items = Show.where(grid_id: grid.id)
            elsif grid.class_type == 'Channel'
                if grid.sort == 'Alphabetical'
                    items = Channel.where(grid_id: grid.id).order(name: :asc)
                elsif grid.sort == 'Random'
                    items = Channel.where(grid_id: grid.id).shuffle
                elsif grid.sort == 'New Arrivals/Episodes'
                    items = Channel.where(grid_id: grid.id).order(created_at: :desc)
                end
            elsif grid.class_type == 'Movie'
                if grid.sort == 'Alphabetical'
                    items = Movie.where(grid_id: grid.id).order(name: :asc)
                elsif grid.sort == 'Random'
                    items = Movie.where(grid_id: grid.id).shuffle
                elsif grid.sort == 'New Arrivals/Episodes'
                    items = Movie.where(grid_id: grid.id).order(created_at: :desc)
                end
            end %>

            <div class="panel panel-custom">
                <div class="panel-heading">
                    <div class="icon-left"><span class="glyphicon glyphicon-heart"></span></div>
                    <h3><%= grid.name %></h3>
                    <%= link_to raw('<span class="glyphicon glyphicon-th-large"></span> See All'), full_grid_path(category_id: grid.id), class: 'pull-right' %>
                </div>
                <div class="panel-body scroller">
                    <% grandchild_grids.each do |item| %>
                        <% unless item.adult == true %>
                        <div class="channel">
                            <a href="<%= item.watch_url %>">
                                <div class="channel-img"><%= image_tag item.image_url(:front_page), class: "grayscale" %></div>
                                <h4><%= item.name %></h4>
                            </a>
                        </div>
                        <% end %>
                    <% end %>
                    <% items.each do |item| %>
                        <% unless item.adult == true %>
                        <div class="channel">
                            <a href="<%= item.watch_url %>">
                                <% if item.content_quality == 'HD' %><div class="ribbon"><%= image_tag "ribbon-hd.png" %></div><% end %>
                                <div class="channel-img"><%= image_tag item.image_url(:front_page), class: "grayscale" %></div>
                                <h4><%= item.name %></h4>
                            </a>
                        </div>
                        <% end %>
                    <% end %>
                </div>
            </div><!--pannel-->
        <% end %>

        <%
        if @grid.class_type == 'Show'
            items = Show.where(grid_id: @grid.id)
        elsif @grid.class_type == 'Channel'
            if @grid.sort == 'Alphabetical'
                items = Channel.where(grid_id: @grid.id).order(name: :asc)
            elsif @grid.sort == 'Random'
                items = Channel.where(grid_id: @grid.id).shuffle
            elsif @grid.sort == 'New Arrivals/Episodes'
                items = Channel.where(grid_id: @grid.id).order(created_at: :desc)
            end
        elsif @grid.class_type == 'Movie'
            if @grid.sort == 'Alphabetical'
                items = Movie.where(grid_id: @grid.id).order(name: :asc)
            elsif @grid.sort == 'Random'
                items = Movie.where(grid_id: @grid.id).shuffle
            elsif @grid.sort == 'New Arrivals/Episodes'
                items = Movie.where(grid_id: @grid.id).order(created_at: :desc)
            end
        end
        %>
        <% if items.any? %>
            <div class="panel panel-custom">
                  <div class="panel-heading">
                    <div class="icon-left"><span class="glyphicon glyphicon-heart"></span></div>
                    <h3><%= @grid.name %></h3>
                </div>
                <div class="panel-body">
                    <div class="row row0">
                        <% items.each do |item| %>
                            <div class="col-sm-4 col-md-2 col-xs-6" style='text-align:center'>
                                <div class="channel" style='float:none; margin: auto'>
                                    <a href="<%= item.watch_url %>">
                                        <% if item.content_quality == 'HD' %><div class="ribbon"><%= image_tag "ribbon-hd.png" %></div><% end %>
                                        <div class="channel-img"><%= image_tag item.image_url(:front_page), class: "grayscale" %></div>
                                        <h4><%= item.name %></h4>
                                    </a>
                                </div>
                            </div>
                        <% end %>
                    </div>
                </div>
            </div><!--pannel-->
        <% end %>
    </div>
</div>


<% if (user_signed_in? && current_user.premium?) || admin_signed_in?  %>
    <!-- Nothing -->
<% elsif user_signed_in? && current_user.expired? %>
    <% if @grid.free? %>
        <%= render('videos/partials/expired_account_modal') %>
        <script>$('#modal-expired').modal({show: true})</script>
    <% else %>
        <%= render('videos/partials/expired_account_modal') %>
        <script>
            $('#modal-expired').modal({show: true, keyboard: false, backdrop: 'static'})
            $('#modal-expired').on('hidden.bs.modal', function () {
                window.location = '/'
            })
        </script>
    <% end %>
<% elsif user_signed_in? && user.premium == false && @grid.free == false %>
    <%= render('videos/partials/no_plan') %>
    <script>
        $('#modal-no-plan').modal({show: true, keyboard: false, backdrop: 'static'})
        $('#modal-no-plan').on('hidden.bs.modal', function () {
            window.location = '/'
        })
    </script>
<% else %>
    <%= render('videos/partials/sign_in_modal_grid') %>
    <script>
        $('#modal-login').modal({show: true, keyboard: false, backdrop: 'static'})
        $('#modal-login').on('hidden.bs.modal', function () {
            window.location = '/'
        })
    </script>
<% end %>
